<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Didah Morse Code PDA/Appliance: teensy3_morse_bsp.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Didah Morse Code PDA/Appliance
   &#160;<span id="projectnumber">1.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">teensy3_morse_bsp.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implementation of Teensy 3.0 board support package.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;climits&gt;</code><br />
<code>#include &quot;<a class="el" href="teensy3__morse__bsp_8h_source.html">teensy3_morse_bsp.h</a>&quot;</code><br />
<code>#include &quot;mk20dx128.h&quot;</code><br />
<code>#include &quot;<a class="el" href="cpu_8h_source.html">cpu.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="libmorse_8h_source.html">libmorse.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="voltage__monitor_8h_source.html">voltage_monitor.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for teensy3_morse_bsp.cpp:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="teensy3__morse__bsp_8cpp__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
</div>
<p><a href="teensy3__morse__bsp_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae35f80836869eec0a82e85571e8aa2fd"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae35f80836869eec0a82e85571e8aa2fd"></a>
char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="teensy3__morse__bsp_8cpp.html#ae35f80836869eec0a82e85571e8aa2fd">identifyProcessor</a> ()</td></tr>
<tr class="memdesc:ae35f80836869eec0a82e85571e8aa2fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a pointer to a static string that identifies the processor chip. <br /></td></tr>
<tr class="separator:ae35f80836869eec0a82e85571e8aa2fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6899cd9b83df54106b259ab81ea5cb2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af6899cd9b83df54106b259ab81ea5cb2"></a>
uint16_t&#160;</td><td class="memItemRight" valign="bottom"><b>touchMargin</b> (60)</td></tr>
<tr class="separator:af6899cd9b83df54106b259ab81ea5cb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c9c90d823df58733140d0fa559e0d3f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="teensy3__morse__bsp_8cpp.html#a9c9c90d823df58733140d0fa559e0d3f">calibrateTouch</a> (uint8_t pin)</td></tr>
<tr class="memdesc:a9c9c90d823df58733140d0fa559e0d3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Establish a baseline for a touch sensor when no touch is present.  <a href="#a9c9c90d823df58733140d0fa559e0d3f">More...</a><br /></td></tr>
<tr class="separator:a9c9c90d823df58733140d0fa559e0d3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4a4cda59f6e32a1412e012d69bec6a9"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="teensy3__morse__bsp_8cpp.html#ab4a4cda59f6e32a1412e012d69bec6a9">getPinThreshold</a> (uint8_t pin)</td></tr>
<tr class="memdesc:ab4a4cda59f6e32a1412e012d69bec6a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the pin capacitance in pF.  <a href="#ab4a4cda59f6e32a1412e012d69bec6a9">More...</a><br /></td></tr>
<tr class="separator:ab4a4cda59f6e32a1412e012d69bec6a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab306f692c5c9455a0c82782a67ff0147"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="teensy3__morse__bsp_8cpp.html#ab306f692c5c9455a0c82782a67ff0147">touchPoll</a> (uint8_t pin)</td></tr>
<tr class="separator:ab306f692c5c9455a0c82782a67ff0147"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36cda3a6dd77f2141cfc703c55a47ff8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a36cda3a6dd77f2141cfc703c55a47ff8"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>getDuty</b> ()</td></tr>
<tr class="separator:a36cda3a6dd77f2141cfc703c55a47ff8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a619f9a6011a13d794206fe91d3ac6039"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a619f9a6011a13d794206fe91d3ac6039"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>setDuty</b> (uint8_t dutyCycle)</td></tr>
<tr class="separator:a619f9a6011a13d794206fe91d3ac6039"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac70998cee1bf97f00aec4a1b4e5a4f60"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac70998cee1bf97f00aec4a1b4e5a4f60"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>isEarphonePresent</b> ()</td></tr>
<tr class="separator:ac70998cee1bf97f00aec4a1b4e5a4f60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f674d5b9985ea3a7eeb0df299c2e405"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6f674d5b9985ea3a7eeb0df299c2e405"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>pollEarphonePresent</b> ()</td></tr>
<tr class="separator:a6f674d5b9985ea3a7eeb0df299c2e405"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af66e71e3fac9b6a2c6532bc8a513bfde"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="teensy3__morse__bsp_8cpp.html#af66e71e3fac9b6a2c6532bc8a513bfde">beep</a> (uint32_t frequency, uint32_t durationMicros)</td></tr>
<tr class="memdesc:af66e71e3fac9b6a2c6532bc8a513bfde"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output a square wave on pin 10 at the given frequency for the given duration.  <a href="#af66e71e3fac9b6a2c6532bc8a513bfde">More...</a><br /></td></tr>
<tr class="separator:af66e71e3fac9b6a2c6532bc8a513bfde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8761e874366e227690fba2964e1bc445"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="teensy3__morse__bsp_8cpp.html#a8761e874366e227690fba2964e1bc445">getInternalTemperatureC</a> ()</td></tr>
<tr class="separator:a8761e874366e227690fba2964e1bc445"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8dd28759e56dbd2ee9bc9ae96d1783c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae8dd28759e56dbd2ee9bc9ae96d1783c"></a>
long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="teensy3__morse__bsp_8cpp.html#ae8dd28759e56dbd2ee9bc9ae96d1783c">readMillivolts</a> ()</td></tr>
<tr class="memdesc:ae8dd28759e56dbd2ee9bc9ae96d1783c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the most recent ADC measurement of the input voltage. Perform analog to digital conversion on the analogInput pin, callibrated to the protection diode and voltage divider on the interface/power board. <br /></td></tr>
<tr class="separator:ae8dd28759e56dbd2ee9bc9ae96d1783c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64b1cba37dfee0c21f770334404eb3da"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a64b1cba37dfee0c21f770334404eb3da"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="teensy3__morse__bsp_8cpp.html#a64b1cba37dfee0c21f770334404eb3da">sampleVoltage</a> ()</td></tr>
<tr class="memdesc:a64b1cba37dfee0c21f770334404eb3da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Increment the voltage sampling and filtering. <br /></td></tr>
<tr class="separator:a64b1cba37dfee0c21f770334404eb3da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e9ec9948bd3c498f1d4b7780a4e0fdd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="teensy3__morse__bsp_8cpp.html#a4e9ec9948bd3c498f1d4b7780a4e0fdd">describeRTC</a> ()</td></tr>
<tr class="memdesc:a4e9ec9948bd3c498f1d4b7780a4e0fdd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Report register settings related to the external clock crystal.  <a href="#a4e9ec9948bd3c498f1d4b7780a4e0fdd">More...</a><br /></td></tr>
<tr class="separator:a4e9ec9948bd3c498f1d4b7780a4e0fdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae455f2b0f6df93bdf0c57ab61fc3cc18"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="teensy3__morse__bsp_8cpp.html#ae455f2b0f6df93bdf0c57ab61fc3cc18">hasRTC</a> ()</td></tr>
<tr class="memdesc:ae455f2b0f6df93bdf0c57ab61fc3cc18"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sense whether or not a realtime clock crystal is present.  <a href="#ae455f2b0f6df93bdf0c57ab61fc3cc18">More...</a><br /></td></tr>
<tr class="separator:ae455f2b0f6df93bdf0c57ab61fc3cc18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15bba6162d5a787569acccbf85402f71"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a15bba6162d5a787569acccbf85402f71"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="teensy3__morse__bsp_8cpp.html#a15bba6162d5a787569acccbf85402f71">initPorts</a> ()</td></tr>
<tr class="memdesc:a15bba6162d5a787569acccbf85402f71"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the input and output ports used by appliance or PDA hardware. <br /></td></tr>
<tr class="separator:a15bba6162d5a787569acccbf85402f71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d6b4ace33ed5e497dedd03217540c63"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2d6b4ace33ed5e497dedd03217540c63"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="teensy3__morse__bsp_8cpp.html#a2d6b4ace33ed5e497dedd03217540c63">pwmFrequency</a> (int Hz)</td></tr>
<tr class="memdesc:a2d6b4ace33ed5e497dedd03217540c63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the PWM frequency for the audio output pins. <br /></td></tr>
<tr class="separator:a2d6b4ace33ed5e497dedd03217540c63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82911eac3bf13d6f36d10102a4c4d3c4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a82911eac3bf13d6f36d10102a4c4d3c4"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="teensy3__morse__bsp_8cpp.html#a82911eac3bf13d6f36d10102a4c4d3c4">pwmWrite</a> (int duty)</td></tr>
<tr class="memdesc:a82911eac3bf13d6f36d10102a4c4d3c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a tone on the audio output pins. <br /></td></tr>
<tr class="separator:a82911eac3bf13d6f36d10102a4c4d3c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad27c6a4654c91038ad6d6dbf03b00ddb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad27c6a4654c91038ad6d6dbf03b00ddb"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="teensy3__morse__bsp_8cpp.html#ad27c6a4654c91038ad6d6dbf03b00ddb">dWrite</a> (int value)</td></tr>
<tr class="memdesc:ad27c6a4654c91038ad6d6dbf03b00ddb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform digital writes to all the output pins. <br /></td></tr>
<tr class="separator:ad27c6a4654c91038ad6d6dbf03b00ddb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c982a7d7805f1dd5426eb98c915cfdd"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6c982a7d7805f1dd5426eb98c915cfdd"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="teensy3__morse__bsp_8cpp.html#a6c982a7d7805f1dd5426eb98c915cfdd">redLED</a> (int value)</td></tr>
<tr class="memdesc:a6c982a7d7805f1dd5426eb98c915cfdd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turn the red LED on (1) or off (0). <br /></td></tr>
<tr class="separator:a6c982a7d7805f1dd5426eb98c915cfdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae162e602c712201806b935cb21ce8284"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae162e602c712201806b935cb21ce8284"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="teensy3__morse__bsp_8cpp.html#ae162e602c712201806b935cb21ce8284">greenLED</a> (int value)</td></tr>
<tr class="memdesc:ae162e602c712201806b935cb21ce8284"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turn the green LED on (1) or off (0). <br /></td></tr>
<tr class="separator:ae162e602c712201806b935cb21ce8284"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab28974f7e8f855ec7ba4805642afaaba"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab28974f7e8f855ec7ba4805642afaaba"></a>
uint16_t&#160;</td><td class="memItemRight" valign="bottom"><b>activityLight</b> (0)</td></tr>
<tr class="separator:ab28974f7e8f855ec7ba4805642afaaba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1602f82bf26915dd2e462be2a99fc776"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1602f82bf26915dd2e462be2a99fc776"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="teensy3__morse__bsp_8cpp.html#a1602f82bf26915dd2e462be2a99fc776">toggleGreenLED</a> ()</td></tr>
<tr class="memdesc:a1602f82bf26915dd2e462be2a99fc776"><td class="mdescLeft">&#160;</td><td class="mdescRight">Change the state of the green LED. <br /></td></tr>
<tr class="separator:a1602f82bf26915dd2e462be2a99fc776"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96d5d27859362b51477fd56bcc67fe7c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a96d5d27859362b51477fd56bcc67fe7c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="teensy3__morse__bsp_8cpp.html#a96d5d27859362b51477fd56bcc67fe7c">toggleRedLED</a> ()</td></tr>
<tr class="memdesc:a96d5d27859362b51477fd56bcc67fe7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Change the state of the red LED. <br /></td></tr>
<tr class="separator:a96d5d27859362b51477fd56bcc67fe7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e2da33375826e329ea5f4c8d1d10224"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0e2da33375826e329ea5f4c8d1d10224"></a>
uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="teensy3__morse__bsp_8cpp.html#a0e2da33375826e329ea5f4c8d1d10224">getRawVoltage</a> ()</td></tr>
<tr class="memdesc:a0e2da33375826e329ea5f4c8d1d10224"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the raw analog input. <br /></td></tr>
<tr class="separator:a0e2da33375826e329ea5f4c8d1d10224"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a6d1207ead4b91ce0c9b584f6e57278b7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6d1207ead4b91ce0c9b584f6e57278b7"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><b>cpuid</b> [] = &quot;012345678911234567892123456789&quot;</td></tr>
<tr class="separator:a6d1207ead4b91ce0c9b584f6e57278b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac812d9e42c34ac80e05a4f208529eed4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac812d9e42c34ac80e05a4f208529eed4"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>duty</b> = <a class="el" href="teensy3__morse__bsp_8h.html#ab93f43c2c0685cc210fe129ae3531514">duty50</a></td></tr>
<tr class="separator:ac812d9e42c34ac80e05a4f208529eed4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3aff932829a6c75f4c26a237252468ea"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3aff932829a6c75f4c26a237252468ea"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>earphonePresent</b> = false</td></tr>
<tr class="separator:a3aff932829a6c75f4c26a237252468ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81c70a0b8760d3242791b08856c7aa61"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a81c70a0b8760d3242791b08856c7aa61"></a>
<a class="el" href="classVoltageMonitor.html">VoltageMonitor</a>&#160;</td><td class="memItemRight" valign="bottom"><b>voltageMonitor</b></td></tr>
<tr class="separator:a81c70a0b8760d3242791b08856c7aa61"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation of Teensy 3.0 board support package. </p>

<p>Definition in file <a class="el" href="teensy3__morse__bsp_8cpp_source.html">teensy3_morse_bsp.cpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="af66e71e3fac9b6a2c6532bc8a513bfde"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void beep </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>frequency</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>durationMicros</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Output a square wave on pin 10 at the given frequency for the given duration. </p>
<p>Generate a tone using PWM. </p>

<p>Definition at line <a class="el" href="teensy3__morse__bsp_8cpp_source.html#l00179">179</a> of file <a class="el" href="teensy3__morse__bsp_8cpp_source.html">teensy3_morse_bsp.cpp</a>.</p>

<p>References <a class="el" href="teensy3__morse__bsp_8cpp_source.html#l00315">pwmFrequency()</a>, <a class="el" href="teensy3__morse__bsp_8cpp_source.html#l00321">pwmWrite()</a>, and <a class="el" href="teensy3__morse__bsp_8cpp_source.html#l00339">redLED()</a>.</p>

<p>Referenced by <a class="el" href="morse__digit_8cpp_source.html#l00008">blinkMorseDigit()</a>, <a class="el" href="morse__digit_8cpp_source.html#l00022">bmd096()</a>, <a class="el" href="morse__digit_8cpp_source.html#l00040">bmd104()</a>, and <a class="el" href="libmorse_8cpp_source.html#l00137">txLiteral()</a>.</p>
<div class="fragment"><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                                                       {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;   pollEarphonePresent();</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   <a class="code" href="teensy3__morse__bsp_8cpp.html#a2d6b4ace33ed5e497dedd03217540c63">pwmFrequency</a>(frequency);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;   <a class="code" href="teensy3__morse__bsp_8cpp.html#a82911eac3bf13d6f36d10102a4c4d3c4">pwmWrite</a>(duty);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;   <a class="code" href="teensy3__morse__bsp_8cpp.html#a6c982a7d7805f1dd5426eb98c915cfdd">redLED</a>(1);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;   delayMicroseconds(durationMicros);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   <a class="code" href="teensy3__morse__bsp_8cpp.html#a82911eac3bf13d6f36d10102a4c4d3c4">pwmWrite</a>(0);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   <a class="code" href="teensy3__morse__bsp_8cpp.html#a6c982a7d7805f1dd5426eb98c915cfdd">redLED</a>(0);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;}</div><div class="ttc" id="teensy3__morse__bsp_8cpp_html_a82911eac3bf13d6f36d10102a4c4d3c4"><div class="ttname"><a href="teensy3__morse__bsp_8cpp.html#a82911eac3bf13d6f36d10102a4c4d3c4">pwmWrite</a></div><div class="ttdeci">void pwmWrite(int duty)</div><div class="ttdoc">Generate a tone on the audio output pins. </div><div class="ttdef"><b>Definition:</b> <a href="teensy3__morse__bsp_8cpp_source.html#l00321">teensy3_morse_bsp.cpp:321</a></div></div>
<div class="ttc" id="teensy3__morse__bsp_8cpp_html_a6c982a7d7805f1dd5426eb98c915cfdd"><div class="ttname"><a href="teensy3__morse__bsp_8cpp.html#a6c982a7d7805f1dd5426eb98c915cfdd">redLED</a></div><div class="ttdeci">void redLED(int value)</div><div class="ttdoc">Turn the red LED on (1) or off (0). </div><div class="ttdef"><b>Definition:</b> <a href="teensy3__morse__bsp_8cpp_source.html#l00339">teensy3_morse_bsp.cpp:339</a></div></div>
<div class="ttc" id="teensy3__morse__bsp_8cpp_html_a2d6b4ace33ed5e497dedd03217540c63"><div class="ttname"><a href="teensy3__morse__bsp_8cpp.html#a2d6b4ace33ed5e497dedd03217540c63">pwmFrequency</a></div><div class="ttdeci">void pwmFrequency(int Hz)</div><div class="ttdoc">Set the PWM frequency for the audio output pins. </div><div class="ttdef"><b>Definition:</b> <a href="teensy3__morse__bsp_8cpp_source.html#l00315">teensy3_morse_bsp.cpp:315</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9c9c90d823df58733140d0fa559e0d3f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calibrateTouch </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>pin</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Establish a baseline for a touch sensor when no touch is present. </p>
<p>Measure the noise floor for the given touch pin. A threshold is set 600pF above the maximum measured value. </p>

<p>Definition at line <a class="el" href="teensy3__morse__bsp_8cpp_source.html#l00135">135</a> of file <a class="el" href="teensy3__morse__bsp_8cpp_source.html">teensy3_morse_bsp.cpp</a>.</p>

<p>References <a class="el" href="teensy3__morse__bsp_8cpp_source.html#l00321">pwmWrite()</a>.</p>

<p>Referenced by <a class="el" href="teensy3__morse__bsp_8cpp_source.html#l00266">initPorts()</a>.</p>
<div class="fragment"><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                                 {</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  touchBase[pin] = 0;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i(0); i &lt; 10; ++i) {</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    uint16_t pF20(touchRead(pin));</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="teensy3__morse__bsp_8cpp.html#a82911eac3bf13d6f36d10102a4c4d3c4">pwmWrite</a>(pF20);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    touchBase[pin] = touchBase[pin] &lt; pF20 ? pF20 : touchBase[pin];</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    delay(100);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div><div class="ttc" id="teensy3__morse__bsp_8cpp_html_a82911eac3bf13d6f36d10102a4c4d3c4"><div class="ttname"><a href="teensy3__morse__bsp_8cpp.html#a82911eac3bf13d6f36d10102a4c4d3c4">pwmWrite</a></div><div class="ttdeci">void pwmWrite(int duty)</div><div class="ttdoc">Generate a tone on the audio output pins. </div><div class="ttdef"><b>Definition:</b> <a href="teensy3__morse__bsp_8cpp_source.html#l00321">teensy3_morse_bsp.cpp:321</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4e9ec9948bd3c498f1d4b7780a4e0fdd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void describeRTC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Report register settings related to the external clock crystal. </p>
<p>Turns out by the time user code runs, it's too late to change any of these clock registers.</p>
<p>From <a href="http://forum.pjrc.com/threads/724-32-768-KHz-crystal-and-battery-for-Teensy-3-0-RTC-questions?highlight=RTC_TPR">http://forum.pjrc.com/threads/724-32-768-KHz-crystal-and-battery-for-Teensy-3-0-RTC-questions?highlight=RTC_TPR</a> The bit to use is RTC_SR_TIF, but you can't easily do this because the startup code checks that bit and tries to initialize the RTC. By the time your program is running, it's too late to discover what that bit was before the startup code ran.</p>
<p>There is a startup_early_hook() function you could implement to run your own code very early in the startup. Pretty much nothing is initialized at that point. The most viable solution would be to grab the value of RTC_SR and put it into a static variable. But this code runs before variables are initialized, so you'll have to use an attribute to put that variable into the .noinit section to prevent the later startup code from overwriting it. Then you could check that variable's RTC_SR_TIF bit once your program is running. Or if you don't need to do much, you could perhaps do everything you need in that extremely early startup code.... but that's quite difficult because so much stuff ordinary programming depends upon hasn't been initialized yet. </p>

<p>Definition at line <a class="el" href="teensy3__morse__bsp_8cpp_source.html#l00232">232</a> of file <a class="el" href="teensy3__morse__bsp_8cpp_source.html">teensy3_morse_bsp.cpp</a>.</p>

<p>Referenced by <a class="el" href="actions_8cpp_source.html#l00735">readEvalPrint()</a>.</p>
<div class="fragment"><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                   {</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  printLabelValueUnits(<span class="stringliteral">&quot;RTC_TSR &quot;</span>, RTC_TSR, <span class="stringliteral">&quot; time in seconds&quot;</span>);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  printLabelValueUnits(<span class="stringliteral">&quot;RTC_CR &amp; RTC_CR_CLKO &quot;</span>,</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;               !!(RTC_CR &amp; RTC_CR_CLKO), <span class="stringliteral">&quot; 1=gated&quot;</span>);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  printLabelValueUnits(<span class="stringliteral">&quot;RTC_CR &amp; RTC_CR_OSCE &quot;</span>,</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;               !!(RTC_CR &amp; RTC_CR_OSCE), <span class="stringliteral">&quot; 1=enabled&quot;</span>);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  printLabelValueUnits(<span class="stringliteral">&quot;RTC_SR &amp; RTC_SR_TCE &quot;</span>,</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;               !!(RTC_SR &amp; RTC_SR_TCE), <span class="stringliteral">&quot; 1=enabled&quot;</span>);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  printLabelValueUnits(<span class="stringliteral">&quot;RTC_SR &amp; RTC_SR_TIF &quot;</span>,</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;               !!(RTC_SR &amp; RTC_SR_TIF), <span class="stringliteral">&quot; 1=invalid&quot;</span>);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  printLabelValueUnits(<span class="stringliteral">&quot;RTC_SR &amp; RTC_SR_TCE &quot;</span>,</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;               !!(RTC_SR &amp; RTC_SR_TCE), <span class="stringliteral">&quot; 1=prescale enabled&quot;</span>);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  printLabelValueUnits(<span class="stringliteral">&quot;RTC_TPR &quot;</span>, RTC_TPR, <span class="stringliteral">&quot; prescaler&quot;</span>);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8761e874366e227690fba2964e1bc445"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float getInternalTemperatureC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Report the CPU temperature in Celsius units. Calibration was performed with a refrigerator, a heat gun, and a multimeter with a thermocouple. </p>

<p>Definition at line <a class="el" href="teensy3__morse__bsp_8cpp_source.html#l00193">193</a> of file <a class="el" href="teensy3__morse__bsp_8cpp_source.html">teensy3_morse_bsp.cpp</a>.</p>

<p>Referenced by <a class="el" href="actions_8cpp_source.html#l00456">printLog()</a>, <a class="el" href="actions_8cpp_source.html#l00292">txInternalTemperatureC()</a>, <a class="el" href="actions_8cpp_source.html#l00298">txInternalTemperatureF()</a>, and <a class="el" href="libmorse_8cpp_source.html#l00208">txString()</a>.</p>
<div class="fragment"><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                                {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> offset(343.8);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> gain(-0.02258);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;   <span class="keywordtype">double</span> reading(analogRead(temperatureSensor));</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;   <span class="keywordflow">return</span> offset + gain * reading;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab4a4cda59f6e32a1412e012d69bec6a9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t getPinThreshold </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>pin</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the pin capacitance in pF. </p>
<p>Return the capacitance threshold in internal units of approximately pF/20 per count. </p>

<p>Definition at line <a class="el" href="teensy3__morse__bsp_8cpp_source.html#l00146">146</a> of file <a class="el" href="teensy3__morse__bsp_8cpp_source.html">teensy3_morse_bsp.cpp</a>.</p>

<p>Referenced by <a class="el" href="actions_8cpp_source.html#l00380">txTock()</a>.</p>
<div class="fragment"><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                                      {</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordflow">return</span> 50 * (touchBase[pin] + touchMargin);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae455f2b0f6df93bdf0c57ab61fc3cc18"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool hasRTC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sense whether or not a realtime clock crystal is present. </p>
<p>Alas, all the flags I can find give no indication whether the RTC external clock crystal is or is not present. The RTC prescaler should increment approximately once every 31 microseconds, so we sample the prescaler, wait 33 microseconds, and sample again. If the value is unchanged, there is no RTC external crystal, but if the prescaler value has changed, then there is.</p>
<p>The flags I looked at were the following: !!(RTC_CR &amp; RTC_CR_CLKO) !!(RTC_CR &amp; RTC_CR_OSCE) !!(RTC_SR &amp; RTC_SR_TCE) !!(RTC_SR &amp; RTC_SR_TIF) !!(RTC_SR &amp; RTC_SR_TCE) </p>

<p>Definition at line <a class="el" href="teensy3__morse__bsp_8cpp_source.html#l00260">260</a> of file <a class="el" href="teensy3__morse__bsp_8cpp_source.html">teensy3_morse_bsp.cpp</a>.</p>

<p>Referenced by <a class="el" href="actions_8cpp_source.html#l00735">readEvalPrint()</a>.</p>
<div class="fragment"><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;              {</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  uint32_t prescaler(RTC_TPR);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  delayMicroseconds(33);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keywordflow">return</span> prescaler != RTC_TPR;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab306f692c5c9455a0c82782a67ff0147"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool touchPoll </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>pin</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Poll the given capacitive sensor pin. Return true if the value is greater than the calibration threshold for the pin. </p>

<p>Definition at line <a class="el" href="teensy3__morse__bsp_8cpp_source.html#l00152">152</a> of file <a class="el" href="teensy3__morse__bsp_8cpp_source.html">teensy3_morse_bsp.cpp</a>.</p>

<p>References <a class="el" href="teensy3__morse__bsp_8h_source.html#l00023">duty50</a>.</p>

<p>Referenced by <a class="el" href="libmorse_8cpp_source.html#l00102">flushTouch()</a>, <a class="el" href="libmorse_8cpp_source.html#l00040">getMorse()</a>, <a class="el" href="actions_8cpp_source.html#l00355">getPressure()</a>, <a class="el" href="pda_8cpp_source.html#l00419">txMetronome()</a>, <a class="el" href="libmorse_8cpp_source.html#l00208">txString()</a>, and <a class="el" href="libmorse_8cpp_source.html#l00170">txUnsigned()</a>.</p>
<div class="fragment"><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                            {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  uint16_t pF20(touchRead(pin));</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordflow">return</span> touchBase[pin] + touchMargin &lt; pF20;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Apr 23 2018 13:50:41 for Didah Morse Code PDA/Appliance by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
