<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Didah Morse Code PDA/Appliance: libmorse.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Didah Morse Code PDA/Appliance
   &#160;<span id="projectnumber">1.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">libmorse.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implementation of Morse code operations.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;cstring&gt;</code><br />
<code>#include &lt;limits&gt;</code><br />
<code>#include &quot;Arduino.h&quot;</code><br />
<code>#include &quot;<a class="el" href="libmorse_8h_source.html">libmorse.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="settings_8h_source.html">settings.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="stack_8h_source.html">stack.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="actions_8h_source.html">actions.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="prosign_8h_source.html">prosign.h</a>&quot;</code><br />
<code>#include &quot;Time.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for libmorse.cpp:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="libmorse_8cpp__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
</div>
<p><a href="libmorse_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa0a5df82161f69ca17641cbd43784e39"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa0a5df82161f69ca17641cbd43784e39"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libmorse_8cpp.html#aa0a5df82161f69ca17641cbd43784e39">isIdle</a> ()</td></tr>
<tr class="memdesc:aa0a5df82161f69ca17641cbd43784e39"><td class="mdescLeft">&#160;</td><td class="mdescRight">Has it been at least 600 word gaps since the last activity? <br /></td></tr>
<tr class="separator:aa0a5df82161f69ca17641cbd43784e39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a647dbf56318dc047df6e087c77f10727"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a647dbf56318dc047df6e087c77f10727"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libmorse_8cpp.html#a647dbf56318dc047df6e087c77f10727">letterExpired</a> ()</td></tr>
<tr class="memdesc:a647dbf56318dc047df6e087c77f10727"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if longer than 5 units have elapsed. <br /></td></tr>
<tr class="separator:a647dbf56318dc047df6e087c77f10727"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ec9b75e50f41e98e97ff42e6fa9ca54"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2ec9b75e50f41e98e97ff42e6fa9ca54"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libmorse_8cpp.html#a2ec9b75e50f41e98e97ff42e6fa9ca54">wordExpired</a> ()</td></tr>
<tr class="memdesc:a2ec9b75e50f41e98e97ff42e6fa9ca54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Has it been long enough that the word under construction should be considered complete? <br /></td></tr>
<tr class="separator:a2ec9b75e50f41e98e97ff42e6fa9ca54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4a29ea9b7bb06c2d9e8c4d74f486b91"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMorseToken.html">MorseToken</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libmorse_8cpp.html#ac4a29ea9b7bb06c2d9e8c4d74f486b91">getMorse</a> ()</td></tr>
<tr class="memdesc:ac4a29ea9b7bb06c2d9e8c4d74f486b91"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accumulate a Morse token.  <a href="#ac4a29ea9b7bb06c2d9e8c4d74f486b91">More...</a><br /></td></tr>
<tr class="separator:ac4a29ea9b7bb06c2d9e8c4d74f486b91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3f000c98271c6d0a7710135e18189bc"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac3f000c98271c6d0a7710135e18189bc"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libmorse_8cpp.html#ac3f000c98271c6d0a7710135e18189bc">flushTouch</a> ()</td></tr>
<tr class="memdesc:ac3f000c98271c6d0a7710135e18189bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">On my hardware there is cross-coupling between the serial port and the touch sensors. Without the code below, long messages to the serial port trigger a touch input. <br /></td></tr>
<tr class="separator:ac3f000c98271c6d0a7710135e18189bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab94e088615119d1faae7df22ce50aedf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libmorse_8cpp.html#ab94e088615119d1faae7df22ce50aedf">txError</a> ()</td></tr>
<tr class="memdesc:ab94e088615119d1faae7df22ce50aedf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transmit a Morse code prosign indicating an error.  <a href="#ab94e088615119d1faae7df22ce50aedf">More...</a><br /></td></tr>
<tr class="separator:ab94e088615119d1faae7df22ce50aedf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a817dc726b0c5f8d516c4de0aa92daa19"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a817dc726b0c5f8d516c4de0aa92daa19"></a>
const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libmorse_8cpp.html#a817dc726b0c5f8d516c4de0aa92daa19">m2didah</a> (<a class="el" href="classMorseToken.html">MorseToken</a> code)</td></tr>
<tr class="memdesc:a817dc726b0c5f8d516c4de0aa92daa19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a string of dots and dashes corresponding to code. <br /></td></tr>
<tr class="separator:a817dc726b0c5f8d516c4de0aa92daa19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fdfce728595d72b78dc7c834ab99a40"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libmorse_8cpp.html#a9fdfce728595d72b78dc7c834ab99a40">txLiteral</a> (<a class="el" href="classMorseToken.html">MorseToken</a> code)</td></tr>
<tr class="memdesc:a9fdfce728595d72b78dc7c834ab99a40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transmit a literal Morse code value.  <a href="#a9fdfce728595d72b78dc7c834ab99a40">More...</a><br /></td></tr>
<tr class="separator:a9fdfce728595d72b78dc7c834ab99a40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd4b292f5e412ee4f05aed9dafbc072d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libmorse_8cpp.html#acd4b292f5e412ee4f05aed9dafbc072d">txLetter</a> (char a)</td></tr>
<tr class="memdesc:acd4b292f5e412ee4f05aed9dafbc072d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert an ASCII character into Morse code and transmit it.  <a href="#acd4b292f5e412ee4f05aed9dafbc072d">More...</a><br /></td></tr>
<tr class="separator:acd4b292f5e412ee4f05aed9dafbc072d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47abdd74b66d7180c47d192bab8bdccb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libmorse_8cpp.html#a47abdd74b66d7180c47d192bab8bdccb">txUnsigned</a> (uint16_t n)</td></tr>
<tr class="memdesc:a47abdd74b66d7180c47d192bab8bdccb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transmit an unsigned integer in Morse code.  <a href="#a47abdd74b66d7180c47d192bab8bdccb">More...</a><br /></td></tr>
<tr class="separator:a47abdd74b66d7180c47d192bab8bdccb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ee2308940264ea9ac8e50afc1a4d285"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libmorse_8cpp.html#a0ee2308940264ea9ac8e50afc1a4d285">txString</a> (const char *<a class="el" href="stack_8h.html#abefdfbf9131b5ea5926f9ecbecb6b1e6">s</a>)</td></tr>
<tr class="separator:a0ee2308940264ea9ac8e50afc1a4d285"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa60f07ebee7c34ef41c3dfb64222bb6"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libmorse_8cpp.html#afa60f07ebee7c34ef41c3dfb64222bb6">matchScore</a> (const char *pattern)</td></tr>
<tr class="memdesc:afa60f07ebee7c34ef41c3dfb64222bb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Score the given pattern against the state of the symbol stack.  <a href="#afa60f07ebee7c34ef41c3dfb64222bb6">More...</a><br /></td></tr>
<tr class="separator:afa60f07ebee7c34ef41c3dfb64222bb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25fad1f4d176afaa89839cc897891e78"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libmorse_8cpp.html#a25fad1f4d176afaa89839cc897891e78">rxString</a> (char *buffer, size_t n)</td></tr>
<tr class="separator:a25fad1f4d176afaa89839cc897891e78"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a321e03deebf4be28bd72581b33805719"><td class="memItemLeft" align="right" valign="top">elapsedMicros&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libmorse_8cpp.html#a321e03deebf4be28bd72581b33805719">sinceTouch</a></td></tr>
<tr class="separator:a321e03deebf4be28bd72581b33805719"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a4b5f1472e58f67bccad09be3a14427"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7a4b5f1472e58f67bccad09be3a14427"></a>
uint16_t&#160;</td><td class="memItemRight" valign="bottom"><b>leftCode</b> = 1</td></tr>
<tr class="separator:a7a4b5f1472e58f67bccad09be3a14427"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a9b0f3efd6d1c40297f89664a30d67f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6a9b0f3efd6d1c40297f89664a30d67f"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>touchCount</b> = 0</td></tr>
<tr class="separator:a6a9b0f3efd6d1c40297f89664a30d67f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation of Morse code operations. </p>

<p>Definition in file <a class="el" href="libmorse_8cpp_source.html">libmorse.cpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ac4a29ea9b7bb06c2d9e8c4d74f486b91"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMorseToken.html">MorseToken</a> getMorse </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Accumulate a Morse token. </p>
<p>If the token is in progress, return an invalid token. If the token is complete, return it. The caller is expected to call this function repeatedly until a token is completed or until the caller decides to stop for some other reason, e.g. timeout.</p>
<p>The two buttons function like an iambic keyer. Since a dit or dah is echoed after it is keyed in, and during this time the application is not listening or buffering, there's no need for additional debouncing logic. </p>

<p>Definition at line <a class="el" href="libmorse_8cpp_source.html#l00040">40</a> of file <a class="el" href="libmorse_8cpp_source.html">libmorse.cpp</a>.</p>

<p>References <a class="el" href="teensy3__morse__bsp_8h_source.html#l00073">dahPin</a>, <a class="el" href="teensy3__morse__bsp_8h_source.html#l00070">ditPin</a>, <a class="el" href="settings_8cpp_source.html#l00120">getTxHz()</a>, <a class="el" href="settings_8cpp_source.html#l00124">setTxHz()</a>, <a class="el" href="libmorse_8cpp_source.html#l00017">sinceTouch</a>, <a class="el" href="teensy3__morse__bsp_8cpp_source.html#l00152">touchPoll()</a>, <a class="el" href="libmorse_8cpp_source.html#l00114">txError()</a>, <a class="el" href="libmorse_8cpp_source.html#l00159">txLetter()</a>, <a class="el" href="actions_8cpp_source.html#l00370">txTick()</a>, and <a class="el" href="libmorse_8cpp_source.html#l00035">wordExpired()</a>.</p>

<p>Referenced by <a class="el" href="libmorse_8cpp_source.html#l00265">matchScore()</a>, and <a class="el" href="libmorse_8cpp_source.html#l00392">rxString()</a>.</p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                      {</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordtype">bool</span> ePin(<a class="code" href="teensy3__morse__bsp_8cpp.html#ab306f692c5c9455a0c82782a67ff0147">touchPoll</a>(<a class="code" href="teensy3__morse__bsp_8h.html#a7dfdb474e15d2999d01fd0018d83ea68">ditPin</a>));</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordtype">bool</span> tPin(<a class="code" href="teensy3__morse__bsp_8cpp.html#ab306f692c5c9455a0c82782a67ff0147">touchPoll</a>(<a class="code" href="teensy3__morse__bsp_8h.html#a6036abb02500d6edb26b1ba860014f9d">dahPin</a>));</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  </div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordflow">if</span> (ePin || tPin) {</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="libmorse_8cpp.html#a321e03deebf4be28bd72581b33805719">sinceTouch</a> = 0;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    ++touchCount;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  }</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  uint32_t saveTxHz(<a class="code" href="settings_8cpp.html#a8575b9b52638114a4f32d1462cf9b7c1">getTxHz</a>());</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="comment">// Set the pitch to A#4 for user transmission.</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <a class="code" href="settings_8cpp.html#af33969eee39a5fffb3ceb43a77772dc9">setTxHz</a>(466);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordflow">if</span> (ePin &amp;&amp; !tPin) { <span class="comment">// Touching only E...</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="libmorse_8cpp.html#acd4b292f5e412ee4f05aed9dafbc072d">txLetter</a>(<span class="charliteral">&#39;E&#39;</span>);     <span class="comment">// A single dit</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    leftCode &lt;&lt;= 1;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  }</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  </div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordflow">if</span> (!ePin &amp;&amp; tPin) { <span class="comment">// Touching only T...</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="libmorse_8cpp.html#acd4b292f5e412ee4f05aed9dafbc072d">txLetter</a>(<span class="charliteral">&#39;T&#39;</span>);     <span class="comment">// A single dah</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    leftCode = leftCode &lt;&lt; 1 | 1;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  }</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  </div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordflow">if</span> (ePin &amp;&amp; tPin) { <span class="comment">// Touching both E and T...</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">if</span> (leftCode &amp; 1) {</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <a class="code" href="libmorse_8cpp.html#acd4b292f5e412ee4f05aed9dafbc072d">txLetter</a>(<span class="charliteral">&#39;E&#39;</span>);     <span class="comment">// A single dit</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      leftCode &lt;&lt;= 1;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      ++touchCount;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    }</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="libmorse_8cpp.html#acd4b292f5e412ee4f05aed9dafbc072d">txLetter</a>(<span class="charliteral">&#39;T&#39;</span>);     <span class="comment">// A single dah</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    leftCode = leftCode &lt;&lt; 1 | 1;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  }</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  </div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordflow">if</span> (wordBits &lt;= touchCount) {</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="libmorse_8cpp.html#ab94e088615119d1faae7df22ce50aedf">txError</a>();</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    touchCount = 0;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    leftCode = 1;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="libmorse_8cpp.html#a321e03deebf4be28bd72581b33805719">sinceTouch</a> = 0;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  }</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="comment">// Set the pitch to A4 for the system transmission.</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <a class="code" href="settings_8cpp.html#af33969eee39a5fffb3ceb43a77772dc9">setTxHz</a>(saveTxHz);</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="comment">// End of word timeout...</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">if</span> (leftCode != 1 &amp;&amp; <a class="code" href="libmorse_8cpp.html#a2ec9b75e50f41e98e97ff42e6fa9ca54">wordExpired</a>()) {</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="actions_8cpp.html#a40fea7a424d292e239a5e7a8271728ec">txTick</a>(<a class="code" href="classMorseToken.html">MorseToken</a>());</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">// Convert leftCode to rightCode by shifting and adding a sentinel</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">// in the (new) left-most bit position.</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="classMorseToken.html">MorseToken</a></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      rightCode((leftCode &lt;&lt; 1 | 1) &lt;&lt; (wordBits - touchCount - 1));</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    touchCount = 0;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    leftCode = 1;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">return</span> rightCode;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (touchCount == 0 &amp;&amp; <a class="code" href="libmorse_8cpp.html#a2ec9b75e50f41e98e97ff42e6fa9ca54">wordExpired</a>()) {</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classMorseToken.html">MorseToken</a>(1);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classMorseToken.html">MorseToken</a>();</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  }</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;}</div><div class="ttc" id="libmorse_8cpp_html_a321e03deebf4be28bd72581b33805719"><div class="ttname"><a href="libmorse_8cpp.html#a321e03deebf4be28bd72581b33805719">sinceTouch</a></div><div class="ttdeci">elapsedMicros sinceTouch</div><div class="ttdef"><b>Definition:</b> <a href="libmorse_8cpp_source.html#l00017">libmorse.cpp:17</a></div></div>
<div class="ttc" id="settings_8cpp_html_a8575b9b52638114a4f32d1462cf9b7c1"><div class="ttname"><a href="settings_8cpp.html#a8575b9b52638114a4f32d1462cf9b7c1">getTxHz</a></div><div class="ttdeci">uint32_t getTxHz()</div><div class="ttdoc">Get the transmission frequency (side tone). </div><div class="ttdef"><b>Definition:</b> <a href="settings_8cpp_source.html#l00120">settings.cpp:120</a></div></div>
<div class="ttc" id="actions_8cpp_html_a40fea7a424d292e239a5e7a8271728ec"><div class="ttname"><a href="actions_8cpp.html#a40fea7a424d292e239a5e7a8271728ec">txTick</a></div><div class="ttdeci">void txTick(MorseToken)</div><div class="ttdef"><b>Definition:</b> <a href="actions_8cpp_source.html#l00370">actions.cpp:370</a></div></div>
<div class="ttc" id="libmorse_8cpp_html_acd4b292f5e412ee4f05aed9dafbc072d"><div class="ttname"><a href="libmorse_8cpp.html#acd4b292f5e412ee4f05aed9dafbc072d">txLetter</a></div><div class="ttdeci">void txLetter(char a)</div><div class="ttdoc">Convert an ASCII character into Morse code and transmit it. </div><div class="ttdef"><b>Definition:</b> <a href="libmorse_8cpp_source.html#l00159">libmorse.cpp:159</a></div></div>
<div class="ttc" id="libmorse_8cpp_html_a2ec9b75e50f41e98e97ff42e6fa9ca54"><div class="ttname"><a href="libmorse_8cpp.html#a2ec9b75e50f41e98e97ff42e6fa9ca54">wordExpired</a></div><div class="ttdeci">bool wordExpired()</div><div class="ttdoc">Has it been long enough that the word under construction should be considered complete? </div><div class="ttdef"><b>Definition:</b> <a href="libmorse_8cpp_source.html#l00035">libmorse.cpp:35</a></div></div>
<div class="ttc" id="teensy3__morse__bsp_8h_html_a7dfdb474e15d2999d01fd0018d83ea68"><div class="ttname"><a href="teensy3__morse__bsp_8h.html#a7dfdb474e15d2999d01fd0018d83ea68">ditPin</a></div><div class="ttdeci">const int ditPin</div><div class="ttdoc">A touchRead() pin. Auto-repeats a dit. </div><div class="ttdef"><b>Definition:</b> <a href="teensy3__morse__bsp_8h_source.html#l00070">teensy3_morse_bsp.h:70</a></div></div>
<div class="ttc" id="libmorse_8cpp_html_ab94e088615119d1faae7df22ce50aedf"><div class="ttname"><a href="libmorse_8cpp.html#ab94e088615119d1faae7df22ce50aedf">txError</a></div><div class="ttdeci">void txError()</div><div class="ttdoc">Transmit a Morse code prosign indicating an error. </div><div class="ttdef"><b>Definition:</b> <a href="libmorse_8cpp_source.html#l00114">libmorse.cpp:114</a></div></div>
<div class="ttc" id="settings_8cpp_html_af33969eee39a5fffb3ceb43a77772dc9"><div class="ttname"><a href="settings_8cpp.html#af33969eee39a5fffb3ceb43a77772dc9">setTxHz</a></div><div class="ttdeci">void setTxHz(uint32_t Hz)</div><div class="ttdoc">Set the transmission frequency (side tone). </div><div class="ttdef"><b>Definition:</b> <a href="settings_8cpp_source.html#l00124">settings.cpp:124</a></div></div>
<div class="ttc" id="teensy3__morse__bsp_8cpp_html_ab306f692c5c9455a0c82782a67ff0147"><div class="ttname"><a href="teensy3__morse__bsp_8cpp.html#ab306f692c5c9455a0c82782a67ff0147">touchPoll</a></div><div class="ttdeci">bool touchPoll(uint8_t pin)</div><div class="ttdef"><b>Definition:</b> <a href="teensy3__morse__bsp_8cpp_source.html#l00152">teensy3_morse_bsp.cpp:152</a></div></div>
<div class="ttc" id="teensy3__morse__bsp_8h_html_a6036abb02500d6edb26b1ba860014f9d"><div class="ttname"><a href="teensy3__morse__bsp_8h.html#a6036abb02500d6edb26b1ba860014f9d">dahPin</a></div><div class="ttdeci">const int dahPin</div><div class="ttdoc">A touchRead() pin. Auto-repeats a dah. </div><div class="ttdef"><b>Definition:</b> <a href="teensy3__morse__bsp_8h_source.html#l00073">teensy3_morse_bsp.h:73</a></div></div>
<div class="ttc" id="classMorseToken_html"><div class="ttname"><a href="classMorseToken.html">MorseToken</a></div><div class="ttdoc">Represents an individual Morse code token, such as a letter, pause, or prosign. </div><div class="ttdef"><b>Definition:</b> <a href="morse__token_8h_source.html#l00040">morse_token.h:40</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afa60f07ebee7c34ef41c3dfb64222bb6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t matchScore </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pattern</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Score the given pattern against the state of the symbol stack. </p>
<p>The maximum score is 255 and decreases with increased distance from the pattern.</p>
<ul>
<li><code>A-Z</code>, <code>0-9</code>, punctuation - Match a literal character </li>
<li><code>^CQ^</code> - Match a prosign </li>
<li>space - Match a word-length or greater pause </li>
<li><code>a</code> - Match a single letter from A-Z </li>
<li><code>c</code> - Match any character </li>
<li><code>d</code> - Match a single digit </li>
<li><code>n</code> - Match a contiguous sequence of digits</li>
</ul>
<p>With the exception of <code>n</code>, all the pattern elements match one Morse token. The following punctuation is accepted: </p><pre class="fragment">!"$&amp;'()+,-./:;=?@_               </pre><p>The pattern is compared to the stack starting at the end of the pattern and the top of the stack. There is no support for backtracking. All pattern elements are greedy. </p>

<p>Definition at line <a class="el" href="libmorse_8cpp_source.html#l00265">265</a> of file <a class="el" href="libmorse_8cpp_source.html">libmorse.cpp</a>.</p>

<p>References <a class="el" href="settings_8cpp_source.html#l00187">getDitMicros()</a>, <a class="el" href="libmorse_8cpp_source.html#l00040">getMorse()</a>, <a class="el" href="prosign_8h_source.html#l00027">MORSE_AR</a>, <a class="el" href="prosign_8h_source.html#l00035">MORSE_BT</a>, <a class="el" href="stack_8cpp_source.html#l00017">s()</a>, <a class="el" href="stack_8cpp_source.html#l00012">symbolStackSize()</a>, <a class="el" href="libmorse_8cpp_source.html#l00208">txString()</a>, and <a class="el" href="actions_8cpp_source.html#l00380">txTock()</a>.</p>

<p>Referenced by <a class="el" href="actions_8cpp_source.html#l00076">dispatchOnStack()</a>.</p>
<div class="fragment"><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                                        {</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;   uint8_t score(255);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span>* patEnd(pattern);</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;   <span class="keywordflow">while</span> (*patEnd) ++patEnd;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span>* patSym(patEnd);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;   <span class="keywordflow">if</span> (patSym == pattern) {</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      score = 0;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <span class="comment">// Null pattern never matches.</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="keywordflow">return</span> score;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;   }</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;   --patSym;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;   <span class="keywordtype">size_t</span> sp(0);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;   <span class="keywordtype">bool</span> sawDigit(<span class="keyword">false</span>);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;   <span class="keywordflow">do</span> {</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <span class="keywordtype">char</span> si(<a class="code" href="stack_8cpp.html#abefdfbf9131b5ea5926f9ecbecb6b1e6">s</a>(sp).toChar());</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="keywordflow">switch</span> (*patSym) {</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;a&#39;</span>:</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;         <span class="comment">// Match any (simple greedy match).</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;         <span class="comment">// Must occur at the beginning of the pattern.</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;         <span class="keywordflow">return</span> score;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>:</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;         <span class="comment">// Match a character.</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;         score -= score &amp;&amp; !isalnum(si);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;d&#39;</span>:</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;         <span class="comment">// Match a digit.</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;         score -= score &amp;&amp; (uint8_t(9U) &lt; uint8_t(si - <span class="charliteral">&#39;0&#39;</span>));</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;n&#39;</span>:</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;         <span class="comment">// Match one or more digits.</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;         <span class="comment">// Note: only the stack size limits the number of digits.</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;         <span class="keywordflow">if</span> (uint8_t(si - <span class="charliteral">&#39;0&#39;</span>) &lt; 10U) {</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            sawDigit = <span class="keyword">true</span>;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            <span class="comment">// Don&#39;t advance to the next character of pattern.</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            ++patSym;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <span class="keywordflow">if</span> (!sawDigit) {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;               score -= !!score;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;               <span class="comment">// Finished matching n. Advance the pattern, but reuse</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;               <span class="comment">// the current stack element.</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;               --sp;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            }</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;         }</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;^&#39;</span>: {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;         <span class="comment">// Match a prosign.</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;         <span class="comment">// Note: This code is just enough different than txString to</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;         <span class="comment">// be annoying.</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;         <span class="keywordtype">char</span> pbuffer[5] = { <span class="charliteral">&#39;1&#39;</span>, <span class="charliteral">&#39;2&#39;</span>, <span class="charliteral">&#39;3&#39;</span>, <span class="charliteral">&#39;4&#39;</span>, <span class="charliteral">&#39;\0&#39;</span> };</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;         <span class="keywordtype">char</span>* pb(pbuffer);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;         --patSym;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;         <span class="keywordflow">while</span> (*patSym &amp;&amp; (*patSym != <span class="charliteral">&#39;^&#39;</span>)) {</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            *pb++ = *patSym--;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;         }</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;         --patSym;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;         *pb-- = 0;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;         <span class="comment">// Reverse pbuffer since we&#39;re matching backwards, but the</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;         <span class="comment">// prosign is a single multi-character entity.</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;         <span class="keywordtype">char</span>* fb(pbuffer);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;         <span class="keywordflow">while</span> (fb &lt; pb) {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <span class="keywordtype">char</span> temp(*fb);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            *fb++ = *pb;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            *pb-- = temp;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;         }</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;         score -= score &amp;&amp;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            uint8_t(<a class="code" href="classMorseToken.html">MorseToken</a>(pbuffer, MorseToken::Prosign)) != <a class="code" href="stack_8cpp.html#abefdfbf9131b5ea5926f9ecbecb6b1e6">s</a>(sp);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;         <span class="comment">// Match the literal value of c.</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;         score -= score &amp;&amp; si != uint8_t(*patSym);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      };</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;   } <span class="keywordflow">while</span> (pattern &lt; patSym-- &amp;&amp; ++sp != <a class="code" href="stack_8cpp.html#aafac4a86d14d59c34565bc295024e511">symbolStackSize</a>());</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;   <span class="keywordflow">if</span> (pattern != patSym &amp;&amp; sp == <a class="code" href="stack_8cpp.html#aafac4a86d14d59c34565bc295024e511">symbolStackSize</a>()) {</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <span class="comment">// If the pattern wasn&#39;t used completely deduct a point for</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <span class="comment">// ever unused pattern symbol.</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      score -= patSym - pattern;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;   }</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;   <span class="keywordflow">return</span> score;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;}</div><div class="ttc" id="stack_8cpp_html_abefdfbf9131b5ea5926f9ecbecb6b1e6"><div class="ttname"><a href="stack_8cpp.html#abefdfbf9131b5ea5926f9ecbecb6b1e6">s</a></div><div class="ttdeci">MorseToken s(size_t i)</div><div class="ttdoc">Access the stack using an index where 0 is the top of the stack. </div><div class="ttdef"><b>Definition:</b> <a href="stack_8cpp_source.html#l00017">stack.cpp:17</a></div></div>
<div class="ttc" id="stack_8cpp_html_aafac4a86d14d59c34565bc295024e511"><div class="ttname"><a href="stack_8cpp.html#aafac4a86d14d59c34565bc295024e511">symbolStackSize</a></div><div class="ttdeci">size_t symbolStackSize()</div><div class="ttdef"><b>Definition:</b> <a href="stack_8cpp_source.html#l00012">stack.cpp:12</a></div></div>
<div class="ttc" id="classMorseToken_html"><div class="ttname"><a href="classMorseToken.html">MorseToken</a></div><div class="ttdoc">Represents an individual Morse code token, such as a letter, pause, or prosign. </div><div class="ttdef"><b>Definition:</b> <a href="morse__token_8h_source.html#l00040">morse_token.h:40</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a25fad1f4d176afaa89839cc897891e78"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rxString </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Receive keying into buffer until <em>AR</em> prosign is received, timeout, or buffer full. </p><dl class="section note"><dt>Note</dt><dd>n should be positive. If n == 0, a null will be written to buffer[0] and the function will return immediately. </dd></dl>

<p>Definition at line <a class="el" href="libmorse_8cpp_source.html#l00392">392</a> of file <a class="el" href="libmorse_8cpp_source.html">libmorse.cpp</a>.</p>

<p>References <a class="el" href="settings_8cpp_source.html#l00187">getDitMicros()</a>, <a class="el" href="libmorse_8cpp_source.html#l00040">getMorse()</a>, <a class="el" href="prosign_8h_source.html#l00027">MORSE_AR</a>, <a class="el" href="libmorse_8cpp_source.html#l00208">txString()</a>, and <a class="el" href="actions_8cpp_source.html#l00380">txTock()</a>.</p>

<p>Referenced by <a class="el" href="actions_8cpp_source.html#l00076">dispatchOnStack()</a>.</p>
<div class="fragment"><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                                      {</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;   <span class="keywordtype">char</span>* p(buffer);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span>* e(buffer + n - 1);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;   <span class="keywordtype">bool</span> didSpace(<span class="keyword">true</span>);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;   elapsedMicros sinceKeyboard(0);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;   <span class="keywordtype">char</span> c0(<span class="charliteral">&#39; &#39;</span>);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;   <span class="keywordtype">char</span> c1(<span class="charliteral">&#39; &#39;</span>);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;   <a class="code" href="classMorseToken.html">MorseToken</a> ar(<a class="code" href="prosign_8h.html#a49c7b0fa0eadfc4603bbf1e2f5cd00ed">MORSE_AR</a>);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;   <span class="keywordflow">for</span> (<a class="code" href="classMorseToken.html">MorseToken</a> m(<a class="code" href="libmorse_8cpp.html#ac4a29ea9b7bb06c2d9e8c4d74f486b91">getMorse</a>()); p &lt; e &amp;&amp;  m != ar; m = <a class="code" href="libmorse_8cpp.html#ac4a29ea9b7bb06c2d9e8c4d74f486b91">getMorse</a>()) {</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="keywordflow">if</span> (m.valid()) {</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">char</span> c(m.toChar());</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;         <span class="keywordflow">if</span> (c0 == <span class="charliteral">&#39; &#39;</span> &amp;&amp;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;             c1 == <span class="charliteral">&#39;?&#39;</span> &amp;&amp;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;             (c == <span class="charliteral">&#39;V&#39;</span> || c == <span class="charliteral">&#39;F&#39;</span> || c == <span class="charliteral">&#39;C&#39;</span> || c == <span class="charliteral">&#39;T&#39;</span>))</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;         {</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            <span class="comment">// Convert &quot; ?V&quot; to &quot; %V&quot; so that voltage is substituted</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            <span class="comment">// on transmission. Likewise for ?C, ?F, and ?T.</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            *(p - 1) = <span class="charliteral">&#39;%&#39;</span>;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            Serial.print(<span class="charliteral">&#39;%&#39;</span>);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;         }</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;         *p++ = c;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;         c0 = c1;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;         c1 = c;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;         Serial.print(c);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;         didSpace = <span class="keyword">false</span>;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;         sinceKeyboard = 0;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m.pause() &amp;&amp;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                 (20U * <a class="code" href="settings_8cpp.html#a960551e90dfdad18f3c9b1338ccba7db">getDitMicros</a>() &lt; sinceKeyboard) &amp;&amp; !didSpace)</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;         {</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            <a class="code" href="actions_8cpp.html#a7b222d103bfa3f308965abdf4b9d8d8e">txTock</a>(<a class="code" href="classMorseToken.html">MorseToken</a>());</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            c0 = c1;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            c1 = <span class="charliteral">&#39; &#39;</span>;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            *p++ = <span class="charliteral">&#39; &#39;</span>;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            Serial.print(<span class="charliteral">&#39; &#39;</span>);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            didSpace = <span class="keyword">true</span>;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m.pause() &amp;&amp; (200U * <a class="code" href="settings_8cpp.html#a960551e90dfdad18f3c9b1338ccba7db">getDitMicros</a>() &lt; sinceKeyboard)) {</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            Serial.println(<span class="stringliteral">&quot;Timeout&quot;</span>);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;         }</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   }</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;   *p = 0;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;   <span class="keywordflow">if</span> (p == e) {</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      <a class="code" href="libmorse_8cpp.html#a0ee2308940264ea9ac8e50afc1a4d285">txString</a>(<span class="stringliteral">&quot;FULL&quot;</span>);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;   }</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;   <a class="code" href="libmorse_8cpp.html#a0ee2308940264ea9ac8e50afc1a4d285">txString</a>(<span class="stringliteral">&quot;?&quot;</span>);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;}</div><div class="ttc" id="libmorse_8cpp_html_ac4a29ea9b7bb06c2d9e8c4d74f486b91"><div class="ttname"><a href="libmorse_8cpp.html#ac4a29ea9b7bb06c2d9e8c4d74f486b91">getMorse</a></div><div class="ttdeci">MorseToken getMorse()</div><div class="ttdoc">Accumulate a Morse token. </div><div class="ttdef"><b>Definition:</b> <a href="libmorse_8cpp_source.html#l00040">libmorse.cpp:40</a></div></div>
<div class="ttc" id="libmorse_8cpp_html_a0ee2308940264ea9ac8e50afc1a4d285"><div class="ttname"><a href="libmorse_8cpp.html#a0ee2308940264ea9ac8e50afc1a4d285">txString</a></div><div class="ttdeci">void txString(const char *s)</div><div class="ttdef"><b>Definition:</b> <a href="libmorse_8cpp_source.html#l00208">libmorse.cpp:208</a></div></div>
<div class="ttc" id="prosign_8h_html_a49c7b0fa0eadfc4603bbf1e2f5cd00ed"><div class="ttname"><a href="prosign_8h.html#a49c7b0fa0eadfc4603bbf1e2f5cd00ed">MORSE_AR</a></div><div class="ttdeci">#define MORSE_AR</div><div class="ttdoc">Finished copying. </div><div class="ttdef"><b>Definition:</b> <a href="prosign_8h_source.html#l00027">prosign.h:27</a></div></div>
<div class="ttc" id="actions_8cpp_html_a7b222d103bfa3f308965abdf4b9d8d8e"><div class="ttname"><a href="actions_8cpp.html#a7b222d103bfa3f308965abdf4b9d8d8e">txTock</a></div><div class="ttdeci">void txTock(MorseToken)</div><div class="ttdef"><b>Definition:</b> <a href="actions_8cpp_source.html#l00380">actions.cpp:380</a></div></div>
<div class="ttc" id="settings_8cpp_html_a960551e90dfdad18f3c9b1338ccba7db"><div class="ttname"><a href="settings_8cpp.html#a960551e90dfdad18f3c9b1338ccba7db">getDitMicros</a></div><div class="ttdeci">uint32_t getDitMicros()</div><div class="ttdoc">Get the dit duration in microseconds. </div><div class="ttdef"><b>Definition:</b> <a href="settings_8cpp_source.html#l00187">settings.cpp:187</a></div></div>
<div class="ttc" id="classMorseToken_html"><div class="ttname"><a href="classMorseToken.html">MorseToken</a></div><div class="ttdoc">Represents an individual Morse code token, such as a letter, pause, or prosign. </div><div class="ttdef"><b>Definition:</b> <a href="morse__token_8h_source.html#l00040">morse_token.h:40</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab94e088615119d1faae7df22ce50aedf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void txError </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transmit a Morse code prosign indicating an error. </p>
<p>Transmit a Morse code prosign indicating an error. 8 dits. </p>

<p>Definition at line <a class="el" href="libmorse_8cpp_source.html#l00114">114</a> of file <a class="el" href="libmorse_8cpp_source.html">libmorse.cpp</a>.</p>

<p>References <a class="el" href="libmorse_8cpp_source.html#l00208">txString()</a>.</p>

<p>Referenced by <a class="el" href="pda_8cpp_source.html#l00595">askNext()</a>, <a class="el" href="actions_8cpp_source.html#l00076">dispatchOnStack()</a>, <a class="el" href="stack_8cpp_source.html#l00038">exchangeStack()</a>, <a class="el" href="actions_8cpp_source.html#l00441">getFormatForState()</a>, <a class="el" href="libmorse_8cpp_source.html#l00040">getMorse()</a>, <a class="el" href="pda_8cpp_source.html#l00521">gradeSum()</a>, <a class="el" href="morse__token_8cpp_source.html#l00115">m2i()</a>, <a class="el" href="pda_8cpp_source.html#l00260">playNote()</a>, <a class="el" href="pda_8cpp_source.html#l00135">playSoundEffect()</a>, <a class="el" href="actions_8cpp_source.html#l00060">restoreActions()</a>, <a class="el" href="actions_8cpp_source.html#l00326">speedUp()</a>, <a class="el" href="pda_8cpp_source.html#l00289">txAlphabetSong()</a>, <a class="el" href="pda_8cpp_source.html#l00384">txAlphaNNN()</a>, <a class="el" href="libmorse_8cpp_source.html#l00159">txLetter()</a>, <a class="el" href="libmorse_8cpp_source.html#l00137">txLiteral()</a>, and <a class="el" href="pda_8cpp_source.html#l00419">txMetronome()</a>.</p>
<div class="fragment"><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;               {</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  Serial.print(<span class="stringliteral">&quot;Error [........] &quot;</span>);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <a class="code" href="libmorse_8cpp.html#a0ee2308940264ea9ac8e50afc1a4d285">txString</a>(<span class="stringliteral">&quot;EEEEEEEE&quot;</span>);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;}</div><div class="ttc" id="libmorse_8cpp_html_a0ee2308940264ea9ac8e50afc1a4d285"><div class="ttname"><a href="libmorse_8cpp.html#a0ee2308940264ea9ac8e50afc1a4d285">txString</a></div><div class="ttdeci">void txString(const char *s)</div><div class="ttdef"><b>Definition:</b> <a href="libmorse_8cpp_source.html#l00208">libmorse.cpp:208</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acd4b292f5e412ee4f05aed9dafbc072d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void txLetter </td>
          <td>(</td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert an ASCII character into Morse code and transmit it. </p>
<p>Transmit a Morse code symbol consisting of one letter or number. The ASCII-to-Morse translation table is represented as an implicit binary tree. See the header file for details.</p>
<p>If x is not in the set [A-Z0-9], transmit an 'error' prosign. </p>

<p>Definition at line <a class="el" href="libmorse_8cpp_source.html#l00159">159</a> of file <a class="el" href="libmorse_8cpp_source.html">libmorse.cpp</a>.</p>

<p>References <a class="el" href="libmorse_8cpp_source.html#l00114">txError()</a>, and <a class="el" href="libmorse_8cpp_source.html#l00137">txLiteral()</a>.</p>

<p>Referenced by <a class="el" href="libmorse_8cpp_source.html#l00040">getMorse()</a>, <a class="el" href="actions_8cpp_source.html#l00304">txMacAddress()</a>, <a class="el" href="libmorse_8cpp_source.html#l00208">txString()</a>, and <a class="el" href="libmorse_8cpp_source.html#l00170">txUnsigned()</a>.</p>
<div class="fragment"><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                      {</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;   <a class="code" href="classMorseToken.html">MorseToken</a> letterCode(a, MorseToken::Char);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   <span class="keywordflow">if</span> (letterCode != MORSE_ERROR) {</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <a class="code" href="libmorse_8cpp.html#a9fdfce728595d72b78dc7c834ab99a40">txLiteral</a>(letterCode);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <a class="code" href="libmorse_8cpp.html#ab94e088615119d1faae7df22ce50aedf">txError</a>();</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      Serial.println(a);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;   }</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;}</div><div class="ttc" id="libmorse_8cpp_html_a9fdfce728595d72b78dc7c834ab99a40"><div class="ttname"><a href="libmorse_8cpp.html#a9fdfce728595d72b78dc7c834ab99a40">txLiteral</a></div><div class="ttdeci">void txLiteral(MorseToken code)</div><div class="ttdoc">Transmit a literal Morse code value. </div><div class="ttdef"><b>Definition:</b> <a href="libmorse_8cpp_source.html#l00137">libmorse.cpp:137</a></div></div>
<div class="ttc" id="libmorse_8cpp_html_ab94e088615119d1faae7df22ce50aedf"><div class="ttname"><a href="libmorse_8cpp.html#ab94e088615119d1faae7df22ce50aedf">txError</a></div><div class="ttdeci">void txError()</div><div class="ttdoc">Transmit a Morse code prosign indicating an error. </div><div class="ttdef"><b>Definition:</b> <a href="libmorse_8cpp_source.html#l00114">libmorse.cpp:114</a></div></div>
<div class="ttc" id="classMorseToken_html"><div class="ttname"><a href="classMorseToken.html">MorseToken</a></div><div class="ttdoc">Represents an individual Morse code token, such as a letter, pause, or prosign. </div><div class="ttdef"><b>Definition:</b> <a href="morse__token_8h_source.html#l00040">morse_token.h:40</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9fdfce728595d72b78dc7c834ab99a40"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void txLiteral </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMorseToken.html">MorseToken</a>&#160;</td>
          <td class="paramname"><em>code</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transmit a literal Morse code value. </p>
<p>Transmit a Morse code symbol. The parameter is encoded as a left-justified bit sequence where 0 represents dit and 1 represents dah. Since Morse code symbols vary in length, the code is terminated with a 1 after the right- most token. </p>

<p>Definition at line <a class="el" href="libmorse_8cpp_source.html#l00137">137</a> of file <a class="el" href="libmorse_8cpp_source.html">libmorse.cpp</a>.</p>

<p>References <a class="el" href="teensy3__morse__bsp_8cpp_source.html#l00179">beep()</a>, <a class="el" href="libmorse_8h_source.html#l00019">dahFactor</a>, <a class="el" href="libmorse_8h_source.html#l00016">ditFactor</a>, <a class="el" href="settings_8cpp_source.html#l00187">getDitMicros()</a>, <a class="el" href="settings_8cpp_source.html#l00120">getTxHz()</a>, <a class="el" href="libmorse_8h_source.html#l00022">letterGapFactor</a>, <a class="el" href="morse__token_8h_source.html#l00022">MORSE_MSB</a>, <a class="el" href="libmorse_8cpp_source.html#l00114">txError()</a>, and <a class="el" href="morse__token_8h_source.html#l00064">MorseToken::valid()</a>.</p>

<p>Referenced by <a class="el" href="actions_8cpp_source.html#l00343">txEcho()</a>, <a class="el" href="libmorse_8cpp_source.html#l00159">txLetter()</a>, <a class="el" href="actions_8cpp_source.html#l00246">txListSymbolStack()</a>, <a class="el" href="libmorse_8cpp_source.html#l00208">txString()</a>, and <a class="el" href="actions_8cpp_source.html#l00242">txSymbolStackTop()</a>.</p>
<div class="fragment"><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                                {</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;   <span class="keywordflow">if</span> (code.<a class="code" href="classMorseToken.html#a48cd72aeb868391449d1f51c1d0bf5cc">valid</a>()) {      <span class="comment">// Guard against an infinite loop.</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      uint8_t raw(code);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="keywordflow">while</span> (raw != <a class="code" href="morse__token_8h.html#a484390b6f58586fc06fb29592a94df25">MORSE_MSB</a>) {</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;         <a class="code" href="teensy3__morse__bsp_8cpp.html#af66e71e3fac9b6a2c6532bc8a513bfde">beep</a>(<a class="code" href="settings_8cpp.html#a8575b9b52638114a4f32d1462cf9b7c1">getTxHz</a>(),</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;              <a class="code" href="settings_8cpp.html#a960551e90dfdad18f3c9b1338ccba7db">getDitMicros</a>() * (raw &amp; <a class="code" href="morse__token_8h.html#a484390b6f58586fc06fb29592a94df25">MORSE_MSB</a> ? <a class="code" href="libmorse_8h.html#ad05edce77935802b06e61c72adcbf1ca">dahFactor</a> : <a class="code" href="libmorse_8h.html#a88047b029a5d96bee7f6bb2406b4597a">ditFactor</a>));</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;         Serial.print(raw &amp; <a class="code" href="morse__token_8h.html#a484390b6f58586fc06fb29592a94df25">MORSE_MSB</a> ? <span class="stringliteral">&quot;_&quot;</span> : <span class="stringliteral">&quot;.&quot;</span>);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;         delayMicroseconds(<a class="code" href="settings_8cpp.html#a960551e90dfdad18f3c9b1338ccba7db">getDitMicros</a>());</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;         raw &lt;&lt;= 1;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      }</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      Serial.print(<span class="charliteral">&#39; &#39;</span>);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      delayMicroseconds((<a class="code" href="libmorse_8h.html#a4132030680b0781a791bdb53d5409765">letterGapFactor</a> - <a class="code" href="libmorse_8h.html#a88047b029a5d96bee7f6bb2406b4597a">ditFactor</a>) * <a class="code" href="settings_8cpp.html#a960551e90dfdad18f3c9b1338ccba7db">getDitMicros</a>());</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <a class="code" href="libmorse_8cpp.html#ab94e088615119d1faae7df22ce50aedf">txError</a>();</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;   }</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;}</div><div class="ttc" id="morse__token_8h_html_a484390b6f58586fc06fb29592a94df25"><div class="ttname"><a href="morse__token_8h.html#a484390b6f58586fc06fb29592a94df25">MORSE_MSB</a></div><div class="ttdeci">#define MORSE_MSB</div><div class="ttdoc">Mask for the high order bit of a MorseToken field. </div><div class="ttdef"><b>Definition:</b> <a href="morse__token_8h_source.html#l00022">morse_token.h:22</a></div></div>
<div class="ttc" id="settings_8cpp_html_a8575b9b52638114a4f32d1462cf9b7c1"><div class="ttname"><a href="settings_8cpp.html#a8575b9b52638114a4f32d1462cf9b7c1">getTxHz</a></div><div class="ttdeci">uint32_t getTxHz()</div><div class="ttdoc">Get the transmission frequency (side tone). </div><div class="ttdef"><b>Definition:</b> <a href="settings_8cpp_source.html#l00120">settings.cpp:120</a></div></div>
<div class="ttc" id="teensy3__morse__bsp_8cpp_html_af66e71e3fac9b6a2c6532bc8a513bfde"><div class="ttname"><a href="teensy3__morse__bsp_8cpp.html#af66e71e3fac9b6a2c6532bc8a513bfde">beep</a></div><div class="ttdeci">void beep(uint32_t frequency, uint32_t durationMicros)</div><div class="ttdoc">Output a square wave on pin 10 at the given frequency for the given duration. </div><div class="ttdef"><b>Definition:</b> <a href="teensy3__morse__bsp_8cpp_source.html#l00179">teensy3_morse_bsp.cpp:179</a></div></div>
<div class="ttc" id="libmorse_8cpp_html_ab94e088615119d1faae7df22ce50aedf"><div class="ttname"><a href="libmorse_8cpp.html#ab94e088615119d1faae7df22ce50aedf">txError</a></div><div class="ttdeci">void txError()</div><div class="ttdoc">Transmit a Morse code prosign indicating an error. </div><div class="ttdef"><b>Definition:</b> <a href="libmorse_8cpp_source.html#l00114">libmorse.cpp:114</a></div></div>
<div class="ttc" id="libmorse_8h_html_ad05edce77935802b06e61c72adcbf1ca"><div class="ttname"><a href="libmorse_8h.html#ad05edce77935802b06e61c72adcbf1ca">dahFactor</a></div><div class="ttdeci">const int dahFactor</div><div class="ttdoc">The dah duration is this factor times the dit duration. </div><div class="ttdef"><b>Definition:</b> <a href="libmorse_8h_source.html#l00019">libmorse.h:19</a></div></div>
<div class="ttc" id="libmorse_8h_html_a4132030680b0781a791bdb53d5409765"><div class="ttname"><a href="libmorse_8h.html#a4132030680b0781a791bdb53d5409765">letterGapFactor</a></div><div class="ttdeci">const int letterGapFactor</div><div class="ttdoc">The inter-letter gap is this factor times the dit duration. </div><div class="ttdef"><b>Definition:</b> <a href="libmorse_8h_source.html#l00022">libmorse.h:22</a></div></div>
<div class="ttc" id="libmorse_8h_html_a88047b029a5d96bee7f6bb2406b4597a"><div class="ttname"><a href="libmorse_8h.html#a88047b029a5d96bee7f6bb2406b4597a">ditFactor</a></div><div class="ttdeci">const int ditFactor</div><div class="ttdoc">A dit lasts one unit of time. </div><div class="ttdef"><b>Definition:</b> <a href="libmorse_8h_source.html#l00016">libmorse.h:16</a></div></div>
<div class="ttc" id="settings_8cpp_html_a960551e90dfdad18f3c9b1338ccba7db"><div class="ttname"><a href="settings_8cpp.html#a960551e90dfdad18f3c9b1338ccba7db">getDitMicros</a></div><div class="ttdeci">uint32_t getDitMicros()</div><div class="ttdoc">Get the dit duration in microseconds. </div><div class="ttdef"><b>Definition:</b> <a href="settings_8cpp_source.html#l00187">settings.cpp:187</a></div></div>
<div class="ttc" id="classMorseToken_html_a48cd72aeb868391449d1f51c1d0bf5cc"><div class="ttname"><a href="classMorseToken.html#a48cd72aeb868391449d1f51c1d0bf5cc">MorseToken::valid</a></div><div class="ttdeci">bool valid()</div><div class="ttdoc">Treat code == 0 as the error token. </div><div class="ttdef"><b>Definition:</b> <a href="morse__token_8h_source.html#l00064">morse_token.h:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0ee2308940264ea9ac8e50afc1a4d285"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void txString </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Transmit a Morse code string. Prosigns are delimited by carets (^), e.g. "^QTR^ 2112". Caret is used instead of underscore so that underscores can be transmitted without quoting them or encoding them somehow.</p>
<p>Several format placeholders are supported.</p>
<ul>
<li>C - Transmit the temperature in degrees Celsius </li>
<li>F - Transmit the temperature in degrees Fahrenheit </li>
<li>T - Transmit the 24-hour time as four-digits </li>
<li>U - Transmit the uptime in quarter hours </li>
<li>V - Transmit the millivolts measured by pin analogInput </li>
<li>%% - Transmit a literal percent sign (not that anyone will understand this obscure Morse code)</li>
</ul>
<p>Abort if the dit key is touched. </p>

<p>Definition at line <a class="el" href="libmorse_8cpp_source.html#l00208">208</a> of file <a class="el" href="libmorse_8cpp_source.html">libmorse.cpp</a>.</p>

<p>References <a class="el" href="teensy3__morse__bsp_8h_source.html#l00073">dahPin</a>, <a class="el" href="teensy3__morse__bsp_8h_source.html#l00070">ditPin</a>, <a class="el" href="libmorse_8cpp_source.html#l00102">flushTouch()</a>, <a class="el" href="settings_8cpp_source.html#l00187">getDitMicros()</a>, <a class="el" href="teensy3__morse__bsp_8cpp_source.html#l00193">getInternalTemperatureC()</a>, <a class="el" href="libmorse_8h_source.html#l00022">letterGapFactor</a>, <a class="el" href="teensy3__morse__bsp_8cpp_source.html#l00202">readMillivolts()</a>, <a class="el" href="teensy3__morse__bsp_8cpp_source.html#l00152">touchPoll()</a>, <a class="el" href="actions_8cpp_source.html#l00298">txInternalTemperatureF()</a>, <a class="el" href="libmorse_8cpp_source.html#l00159">txLetter()</a>, <a class="el" href="libmorse_8cpp_source.html#l00137">txLiteral()</a>, <a class="el" href="actions_8cpp_source.html#l00255">txTimeHHMM()</a>, <a class="el" href="libmorse_8cpp_source.html#l00170">txUnsigned()</a>, <a class="el" href="actions_8cpp_source.html#l00283">txUptime()</a>, and <a class="el" href="libmorse_8h_source.html#l00025">wordGapFactor</a>.</p>

<p>Referenced by <a class="el" href="pda_8cpp_source.html#l00595">askNext()</a>, <a class="el" href="pda_8cpp_source.html#l00504">askSum()</a>, <a class="el" href="actions_8cpp_source.html#l00076">dispatchOnStack()</a>, <a class="el" href="actions_8cpp_source.html#l00355">getPressure()</a>, <a class="el" href="pda_8cpp_source.html#l00521">gradeSum()</a>, <a class="el" href="libmorse_8cpp_source.html#l00265">matchScore()</a>, <a class="el" href="pda_8cpp_source.html#l00135">playSoundEffect()</a>, <a class="el" href="libmorse_8cpp_source.html#l00392">rxString()</a>, <a class="el" href="actions_8cpp_source.html#l00318">slowDown()</a>, <a class="el" href="actions_8cpp_source.html#l00326">speedUp()</a>, <a class="el" href="pda_8cpp_source.html#l00289">txAlphabetSong()</a>, <a class="el" href="pda_8cpp_source.html#l00384">txAlphaNNN()</a>, <a class="el" href="actions_8cpp_source.html#l00339">txAR()</a>, <a class="el" href="actions_8cpp_source.html#l00343">txEcho()</a>, <a class="el" href="libmorse_8cpp_source.html#l00114">txError()</a>, <a class="el" href="actions_8cpp_source.html#l00349">txGreeting()</a>, <a class="el" href="actions_8cpp_source.html#l00866">txHelp()</a>, <a class="el" href="actions_8cpp_source.html#l00877">txMenu()</a>, <a class="el" href="actions_8cpp_source.html#l00898">txSettings()</a>, <a class="el" href="actions_8cpp_source.html#l00255">txTimeHHMM()</a>, and <a class="el" href="actions_8cpp_source.html#l00266">txTimeVerbose()</a>.</p>
<div class="fragment"><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                             {</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;   <span class="keywordtype">bool</span> gotPercentSign(<span class="keyword">false</span>);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;   <span class="keywordflow">if</span> (*<a class="code" href="stack_8cpp.html#abefdfbf9131b5ea5926f9ecbecb6b1e6">s</a>) {</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">char</span>* p(const_cast&lt;char*&gt;(<a class="code" href="stack_8cpp.html#abefdfbf9131b5ea5926f9ecbecb6b1e6">s</a>));</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;           *p &amp;&amp; !<a class="code" href="teensy3__morse__bsp_8cpp.html#ab306f692c5c9455a0c82782a67ff0147">touchPoll</a>(<a class="code" href="teensy3__morse__bsp_8h.html#a7dfdb474e15d2999d01fd0018d83ea68">ditPin</a>) &amp;&amp; !<a class="code" href="teensy3__morse__bsp_8cpp.html#ab306f692c5c9455a0c82782a67ff0147">touchPoll</a>(<a class="code" href="teensy3__morse__bsp_8h.html#a6036abb02500d6edb26b1ba860014f9d">dahPin</a>);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;           ++p)</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;         {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            <span class="keywordflow">if</span> (*p == <span class="charliteral">&#39; &#39;</span>) {</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;               Serial.print(<span class="charliteral">&#39;/&#39;</span>);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i(0); i &lt; <a class="code" href="libmorse_8h.html#a030f96d2cadb08715e95bd94f14f3f3d">wordGapFactor</a>; ++i) {</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                  delayMicroseconds(<a class="code" href="settings_8cpp.html#a960551e90dfdad18f3c9b1338ccba7db">getDitMicros</a>());</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="teensy3__morse__bsp_8cpp.html#ab306f692c5c9455a0c82782a67ff0147">touchPoll</a>(<a class="code" href="teensy3__morse__bsp_8h.html#a7dfdb474e15d2999d01fd0018d83ea68">ditPin</a>) || <a class="code" href="teensy3__morse__bsp_8cpp.html#ab306f692c5c9455a0c82782a67ff0147">touchPoll</a>(<a class="code" href="teensy3__morse__bsp_8h.html#a6036abb02500d6edb26b1ba860014f9d">dahPin</a>)) {</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                     <span class="keywordflow">return</span>;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                  }</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;               }</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*p == <span class="charliteral">&#39;^&#39;</span>) {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;               <span class="comment">// Accumulate the following prosign and transmit it.</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;               <span class="keywordtype">char</span> pbuffer[5] = { <span class="charliteral">&#39;1&#39;</span>, <span class="charliteral">&#39;2&#39;</span>, <span class="charliteral">&#39;3&#39;</span>, <span class="charliteral">&#39;4&#39;</span>, <span class="charliteral">&#39;\0&#39;</span> };</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;               <span class="keywordtype">char</span>* q(pbuffer);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;               <span class="keywordflow">while</span> (*q &amp;&amp; *++p != <span class="charliteral">&#39;^&#39;</span>) *q++ = *p;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;               *q = 0;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;               <a class="code" href="libmorse_8cpp.html#a9fdfce728595d72b78dc7c834ab99a40">txLiteral</a>(<a class="code" href="classMorseToken.html">MorseToken</a>(pbuffer, MorseToken::Prosign));</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (gotPercentSign) {</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;               <span class="keywordflow">switch</span> (*p) {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;               <span class="keywordflow">case</span> <span class="charliteral">&#39;%&#39;</span>: <a class="code" href="libmorse_8cpp.html#acd4b292f5e412ee4f05aed9dafbc072d">txLetter</a>(*p); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;               <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>:</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;               {</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                  uint16_t t(<a class="code" href="teensy3__morse__bsp_8cpp.html#a8761e874366e227690fba2964e1bc445">getInternalTemperatureC</a>());</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                  <a class="code" href="libmorse_8cpp.html#a47abdd74b66d7180c47d192bab8bdccb">txUnsigned</a>(t);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;               }</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;               <span class="keywordflow">case</span> <span class="charliteral">&#39;F&#39;</span>:</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                  <a class="code" href="actions_8cpp.html#aed718ec1bd4cc7adb2f65d40a6784496">txInternalTemperatureF</a>(<a class="code" href="classMorseToken.html">MorseToken</a>());</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;               <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>: <a class="code" href="actions_8cpp.html#aaabb3ac0c23f35a499bc17efe829f326">txTimeHHMM</a>(<a class="code" href="classMorseToken.html">MorseToken</a>()); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;               <span class="keywordflow">case</span> <span class="charliteral">&#39;U&#39;</span>: <a class="code" href="actions_8cpp.html#ad02149679fa3cc6a4957d1a318408ffd">txUptime</a>(<a class="code" href="classMorseToken.html">MorseToken</a>()); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;               <span class="keywordflow">case</span> <span class="charliteral">&#39;V&#39;</span>: <a class="code" href="libmorse_8cpp.html#a47abdd74b66d7180c47d192bab8bdccb">txUnsigned</a>((uint16_t) <a class="code" href="teensy3__morse__bsp_8cpp.html#ae8dd28759e56dbd2ee9bc9ae96d1783c">readMillivolts</a>()); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;               <span class="keywordflow">default</span>:</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                  <a class="code" href="libmorse_8cpp.html#acd4b292f5e412ee4f05aed9dafbc072d">txLetter</a>(<span class="charliteral">&#39;%&#39;</span>);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                  <a class="code" href="libmorse_8cpp.html#acd4b292f5e412ee4f05aed9dafbc072d">txLetter</a>(*p);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;               }</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;               gotPercentSign = <span class="keyword">false</span>;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*p == <span class="charliteral">&#39;%&#39;</span>) {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;               gotPercentSign = <span class="keyword">true</span>;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;               <a class="code" href="libmorse_8cpp.html#acd4b292f5e412ee4f05aed9dafbc072d">txLetter</a>(*p);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            }</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;         }</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      delayMicroseconds((wordGapFactor - <a class="code" href="libmorse_8h.html#a4132030680b0781a791bdb53d5409765">letterGapFactor</a>) * <a class="code" href="settings_8cpp.html#a960551e90dfdad18f3c9b1338ccba7db">getDitMicros</a>());</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      Serial.println();</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      Serial.println(<a class="code" href="stack_8cpp.html#abefdfbf9131b5ea5926f9ecbecb6b1e6">s</a>);</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <a class="code" href="libmorse_8cpp.html#ac3f000c98271c6d0a7710135e18189bc">flushTouch</a>();</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;   }</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;}</div><div class="ttc" id="actions_8cpp_html_ad02149679fa3cc6a4957d1a318408ffd"><div class="ttname"><a href="actions_8cpp.html#ad02149679fa3cc6a4957d1a318408ffd">txUptime</a></div><div class="ttdeci">void txUptime(MorseToken)</div><div class="ttdoc">Transmit the uptime. </div><div class="ttdef"><b>Definition:</b> <a href="actions_8cpp_source.html#l00283">actions.cpp:283</a></div></div>
<div class="ttc" id="stack_8cpp_html_abefdfbf9131b5ea5926f9ecbecb6b1e6"><div class="ttname"><a href="stack_8cpp.html#abefdfbf9131b5ea5926f9ecbecb6b1e6">s</a></div><div class="ttdeci">MorseToken s(size_t i)</div><div class="ttdoc">Access the stack using an index where 0 is the top of the stack. </div><div class="ttdef"><b>Definition:</b> <a href="stack_8cpp_source.html#l00017">stack.cpp:17</a></div></div>
<div class="ttc" id="libmorse_8cpp_html_acd4b292f5e412ee4f05aed9dafbc072d"><div class="ttname"><a href="libmorse_8cpp.html#acd4b292f5e412ee4f05aed9dafbc072d">txLetter</a></div><div class="ttdeci">void txLetter(char a)</div><div class="ttdoc">Convert an ASCII character into Morse code and transmit it. </div><div class="ttdef"><b>Definition:</b> <a href="libmorse_8cpp_source.html#l00159">libmorse.cpp:159</a></div></div>
<div class="ttc" id="teensy3__morse__bsp_8h_html_a7dfdb474e15d2999d01fd0018d83ea68"><div class="ttname"><a href="teensy3__morse__bsp_8h.html#a7dfdb474e15d2999d01fd0018d83ea68">ditPin</a></div><div class="ttdeci">const int ditPin</div><div class="ttdoc">A touchRead() pin. Auto-repeats a dit. </div><div class="ttdef"><b>Definition:</b> <a href="teensy3__morse__bsp_8h_source.html#l00070">teensy3_morse_bsp.h:70</a></div></div>
<div class="ttc" id="teensy3__morse__bsp_8cpp_html_a8761e874366e227690fba2964e1bc445"><div class="ttname"><a href="teensy3__morse__bsp_8cpp.html#a8761e874366e227690fba2964e1bc445">getInternalTemperatureC</a></div><div class="ttdeci">float getInternalTemperatureC()</div><div class="ttdef"><b>Definition:</b> <a href="teensy3__morse__bsp_8cpp_source.html#l00193">teensy3_morse_bsp.cpp:193</a></div></div>
<div class="ttc" id="libmorse_8cpp_html_a9fdfce728595d72b78dc7c834ab99a40"><div class="ttname"><a href="libmorse_8cpp.html#a9fdfce728595d72b78dc7c834ab99a40">txLiteral</a></div><div class="ttdeci">void txLiteral(MorseToken code)</div><div class="ttdoc">Transmit a literal Morse code value. </div><div class="ttdef"><b>Definition:</b> <a href="libmorse_8cpp_source.html#l00137">libmorse.cpp:137</a></div></div>
<div class="ttc" id="libmorse_8cpp_html_ac3f000c98271c6d0a7710135e18189bc"><div class="ttname"><a href="libmorse_8cpp.html#ac3f000c98271c6d0a7710135e18189bc">flushTouch</a></div><div class="ttdeci">void flushTouch()</div><div class="ttdoc">On my hardware there is cross-coupling between the serial port and the touch sensors. Without the code below, long messages to the serial port trigger a touch input. </div><div class="ttdef"><b>Definition:</b> <a href="libmorse_8cpp_source.html#l00102">libmorse.cpp:102</a></div></div>
<div class="ttc" id="teensy3__morse__bsp_8cpp_html_ae8dd28759e56dbd2ee9bc9ae96d1783c"><div class="ttname"><a href="teensy3__morse__bsp_8cpp.html#ae8dd28759e56dbd2ee9bc9ae96d1783c">readMillivolts</a></div><div class="ttdeci">long readMillivolts()</div><div class="ttdoc">Return the most recent ADC measurement of the input voltage. Perform analog to digital conversion on ...</div><div class="ttdef"><b>Definition:</b> <a href="teensy3__morse__bsp_8cpp_source.html#l00202">teensy3_morse_bsp.cpp:202</a></div></div>
<div class="ttc" id="libmorse_8h_html_a4132030680b0781a791bdb53d5409765"><div class="ttname"><a href="libmorse_8h.html#a4132030680b0781a791bdb53d5409765">letterGapFactor</a></div><div class="ttdeci">const int letterGapFactor</div><div class="ttdoc">The inter-letter gap is this factor times the dit duration. </div><div class="ttdef"><b>Definition:</b> <a href="libmorse_8h_source.html#l00022">libmorse.h:22</a></div></div>
<div class="ttc" id="actions_8cpp_html_aaabb3ac0c23f35a499bc17efe829f326"><div class="ttname"><a href="actions_8cpp.html#aaabb3ac0c23f35a499bc17efe829f326">txTimeHHMM</a></div><div class="ttdeci">void txTimeHHMM(MorseToken code)</div><div class="ttdoc">Transmit the 24-hr time. </div><div class="ttdef"><b>Definition:</b> <a href="actions_8cpp_source.html#l00255">actions.cpp:255</a></div></div>
<div class="ttc" id="libmorse_8cpp_html_a47abdd74b66d7180c47d192bab8bdccb"><div class="ttname"><a href="libmorse_8cpp.html#a47abdd74b66d7180c47d192bab8bdccb">txUnsigned</a></div><div class="ttdeci">void txUnsigned(uint16_t n)</div><div class="ttdoc">Transmit an unsigned integer in Morse code. </div><div class="ttdef"><b>Definition:</b> <a href="libmorse_8cpp_source.html#l00170">libmorse.cpp:170</a></div></div>
<div class="ttc" id="teensy3__morse__bsp_8cpp_html_ab306f692c5c9455a0c82782a67ff0147"><div class="ttname"><a href="teensy3__morse__bsp_8cpp.html#ab306f692c5c9455a0c82782a67ff0147">touchPoll</a></div><div class="ttdeci">bool touchPoll(uint8_t pin)</div><div class="ttdef"><b>Definition:</b> <a href="teensy3__morse__bsp_8cpp_source.html#l00152">teensy3_morse_bsp.cpp:152</a></div></div>
<div class="ttc" id="teensy3__morse__bsp_8h_html_a6036abb02500d6edb26b1ba860014f9d"><div class="ttname"><a href="teensy3__morse__bsp_8h.html#a6036abb02500d6edb26b1ba860014f9d">dahPin</a></div><div class="ttdeci">const int dahPin</div><div class="ttdoc">A touchRead() pin. Auto-repeats a dah. </div><div class="ttdef"><b>Definition:</b> <a href="teensy3__morse__bsp_8h_source.html#l00073">teensy3_morse_bsp.h:73</a></div></div>
<div class="ttc" id="settings_8cpp_html_a960551e90dfdad18f3c9b1338ccba7db"><div class="ttname"><a href="settings_8cpp.html#a960551e90dfdad18f3c9b1338ccba7db">getDitMicros</a></div><div class="ttdeci">uint32_t getDitMicros()</div><div class="ttdoc">Get the dit duration in microseconds. </div><div class="ttdef"><b>Definition:</b> <a href="settings_8cpp_source.html#l00187">settings.cpp:187</a></div></div>
<div class="ttc" id="classMorseToken_html"><div class="ttname"><a href="classMorseToken.html">MorseToken</a></div><div class="ttdoc">Represents an individual Morse code token, such as a letter, pause, or prosign. </div><div class="ttdef"><b>Definition:</b> <a href="morse__token_8h_source.html#l00040">morse_token.h:40</a></div></div>
<div class="ttc" id="libmorse_8h_html_a030f96d2cadb08715e95bd94f14f3f3d"><div class="ttname"><a href="libmorse_8h.html#a030f96d2cadb08715e95bd94f14f3f3d">wordGapFactor</a></div><div class="ttdeci">const int wordGapFactor</div><div class="ttdoc">The inter-word gap is this factor times the dit duration. </div><div class="ttdef"><b>Definition:</b> <a href="libmorse_8h_source.html#l00025">libmorse.h:25</a></div></div>
<div class="ttc" id="actions_8cpp_html_aed718ec1bd4cc7adb2f65d40a6784496"><div class="ttname"><a href="actions_8cpp.html#aed718ec1bd4cc7adb2f65d40a6784496">txInternalTemperatureF</a></div><div class="ttdeci">void txInternalTemperatureF(MorseToken)</div><div class="ttdoc">Transmit the internal temperature in integer in Fahrenheit. </div><div class="ttdef"><b>Definition:</b> <a href="actions_8cpp_source.html#l00298">actions.cpp:298</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a47abdd74b66d7180c47d192bab8bdccb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void txUnsigned </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transmit an unsigned integer in Morse code. </p>
<p>Convert an unsigned integer into a sequence of Morse code numerals and transmit them. </p>

<p>Definition at line <a class="el" href="libmorse_8cpp_source.html#l00170">170</a> of file <a class="el" href="libmorse_8cpp_source.html">libmorse.cpp</a>.</p>

<p>References <a class="el" href="teensy3__morse__bsp_8h_source.html#l00073">dahPin</a>, <a class="el" href="teensy3__morse__bsp_8h_source.html#l00070">ditPin</a>, <a class="el" href="teensy3__morse__bsp_8cpp_source.html#l00152">touchPoll()</a>, and <a class="el" href="libmorse_8cpp_source.html#l00159">txLetter()</a>.</p>

<p>Referenced by <a class="el" href="pda_8cpp_source.html#l00260">playNote()</a>, <a class="el" href="actions_8cpp_source.html#l00292">txInternalTemperatureC()</a>, <a class="el" href="actions_8cpp_source.html#l00298">txInternalTemperatureF()</a>, <a class="el" href="pda_8cpp_source.html#l00419">txMetronome()</a>, <a class="el" href="actions_8cpp_source.html#l00898">txSettings()</a>, <a class="el" href="libmorse_8cpp_source.html#l00208">txString()</a>, and <a class="el" href="actions_8cpp_source.html#l00283">txUptime()</a>.</p>
<div class="fragment"><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                            {</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="comment">// The constant digits10 below is not the maximum number of digits</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="comment">// required to represent the parameter type. Rather, it is the</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">// maximum number of digits that can be represented in a variable of</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="comment">// the given type without change. E.g. the type char can represent</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">// 99, but not 999, so digits10 is 2, not 3, hence we add 1 to store</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="comment">// all the digits that could be needed for input argument n.</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordtype">char</span> digitBuffer[std::numeric_limits&lt;uint16_t&gt;::digits10 + 1];</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  uint16_t digitCount(0);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordflow">do</span> {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">// Convert the least significant digit to ASCII.</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    digitBuffer[digitCount++] = <span class="charliteral">&#39;0&#39;</span> + n % 10;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">// Proceed to the next digit.</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    n /= 10;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  } <span class="keywordflow">while</span> (n);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordflow">while</span> (digitCount &amp;&amp; !<a class="code" href="teensy3__morse__bsp_8cpp.html#ab306f692c5c9455a0c82782a67ff0147">touchPoll</a>(<a class="code" href="teensy3__morse__bsp_8h.html#a7dfdb474e15d2999d01fd0018d83ea68">ditPin</a>) &amp;&amp; !<a class="code" href="teensy3__morse__bsp_8cpp.html#ab306f692c5c9455a0c82782a67ff0147">touchPoll</a>(<a class="code" href="teensy3__morse__bsp_8h.html#a6036abb02500d6edb26b1ba860014f9d">dahPin</a>)) {</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <a class="code" href="libmorse_8cpp.html#acd4b292f5e412ee4f05aed9dafbc072d">txLetter</a>(digitBuffer[--digitCount]);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    Serial.print(digitBuffer[digitCount]);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  }</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  Serial.println(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;}</div><div class="ttc" id="libmorse_8cpp_html_acd4b292f5e412ee4f05aed9dafbc072d"><div class="ttname"><a href="libmorse_8cpp.html#acd4b292f5e412ee4f05aed9dafbc072d">txLetter</a></div><div class="ttdeci">void txLetter(char a)</div><div class="ttdoc">Convert an ASCII character into Morse code and transmit it. </div><div class="ttdef"><b>Definition:</b> <a href="libmorse_8cpp_source.html#l00159">libmorse.cpp:159</a></div></div>
<div class="ttc" id="teensy3__morse__bsp_8h_html_a7dfdb474e15d2999d01fd0018d83ea68"><div class="ttname"><a href="teensy3__morse__bsp_8h.html#a7dfdb474e15d2999d01fd0018d83ea68">ditPin</a></div><div class="ttdeci">const int ditPin</div><div class="ttdoc">A touchRead() pin. Auto-repeats a dit. </div><div class="ttdef"><b>Definition:</b> <a href="teensy3__morse__bsp_8h_source.html#l00070">teensy3_morse_bsp.h:70</a></div></div>
<div class="ttc" id="teensy3__morse__bsp_8cpp_html_ab306f692c5c9455a0c82782a67ff0147"><div class="ttname"><a href="teensy3__morse__bsp_8cpp.html#ab306f692c5c9455a0c82782a67ff0147">touchPoll</a></div><div class="ttdeci">bool touchPoll(uint8_t pin)</div><div class="ttdef"><b>Definition:</b> <a href="teensy3__morse__bsp_8cpp_source.html#l00152">teensy3_morse_bsp.cpp:152</a></div></div>
<div class="ttc" id="teensy3__morse__bsp_8h_html_a6036abb02500d6edb26b1ba860014f9d"><div class="ttname"><a href="teensy3__morse__bsp_8h.html#a6036abb02500d6edb26b1ba860014f9d">dahPin</a></div><div class="ttdeci">const int dahPin</div><div class="ttdoc">A touchRead() pin. Auto-repeats a dah. </div><div class="ttdef"><b>Definition:</b> <a href="teensy3__morse__bsp_8h_source.html#l00073">teensy3_morse_bsp.h:73</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a321e03deebf4be28bd72581b33805719"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">elapsedMicros sinceTouch</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The end of the user's input is determined by a timeout equal to two times the normal word gap. </p>

<p>Definition at line <a class="el" href="libmorse_8cpp_source.html#l00017">17</a> of file <a class="el" href="libmorse_8cpp_source.html">libmorse.cpp</a>.</p>

<p>Referenced by <a class="el" href="libmorse_8cpp_source.html#l00102">flushTouch()</a>, <a class="el" href="libmorse_8cpp_source.html#l00040">getMorse()</a>, <a class="el" href="libmorse_8cpp_source.html#l00025">isIdle()</a>, <a class="el" href="libmorse_8cpp_source.html#l00030">letterExpired()</a>, and <a class="el" href="libmorse_8cpp_source.html#l00035">wordExpired()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Apr 23 2018 12:59:37 for Didah Morse Code PDA/Appliance by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
